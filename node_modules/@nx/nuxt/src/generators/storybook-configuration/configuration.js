"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.storybookConfigurationGenerator = storybookConfigurationGenerator;
const devkit_1 = require("@nx/devkit");
const vue_1 = require("@nx/vue");
/*
 * This generator is basically the Vue one, but for Nuxt we
 * are just adding the styles in `.storybook/preview.ts`
 */
async function storybookConfigurationGenerator(tree, options) {
    const storybookConfigurationGenerator = await (0, vue_1.storybookConfigurationGenerator)(tree, {
        ...options,
        addPlugin: true,
    });
    const { root } = (0, devkit_1.readProjectConfiguration)(tree, options.project);
    tree.write((0, devkit_1.joinPathFragments)(root, '.storybook', 'preview.' + (options.tsConfiguration ? 'ts' : 'js')), `import '../src/assets/css/styles.css';`);
    (0, devkit_1.updateJson)(tree, `${root}/tsconfig.storybook.json`, (json) => {
        json.compilerOptions = {
            ...json.compilerOptions,
            composite: true,
        };
        return json;
    });
    await (0, devkit_1.formatFiles)(tree);
    return (0, devkit_1.runTasksInSerial)(storybookConfigurationGenerator);
}
exports.default = storybookConfigurationGenerator;
